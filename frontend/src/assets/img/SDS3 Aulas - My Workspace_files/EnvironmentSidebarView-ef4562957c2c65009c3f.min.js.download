(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{7794:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"default",(function(){return p}));var n=i(192),s=i.n(n),o=i(1344),r=i.n(o),a=i(4176),c=i(4178),l=i(2920),d=i(2427),h=i(3e3);class p extends n.Component{constructor(e){super(e),this.state={isHovered:!1,isDropdownOpen:!1,isEditing:!1},this.containerRef=this.containerRef.bind(this),this.editText=this.editText.bind(this),this.handleToggleEditName=this.handleToggleEditName.bind(this),this.handleRenameSubmit=this.handleRenameSubmit.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.handleLinkClick=this.handleLinkClick.bind(this),this.getItemClasses=this.getItemClasses.bind(this),this.handleDropdownSelect=this.handleDropdownSelect.bind(this),this.onDropdownToggle=this.onDropdownToggle.bind(this)}getItemClasses(){return r()({"sidebar-list-item":!0,selected:this.props.isSelected,active:this.state.isDropdownOpen},this.props.className)}containerRef(e){this.inlineInput=e}editText(){e.invoke(this.inlineInput,"toggleEdit")}setEditState(e){this.inlineInput.setEditState(e)}getEditState(){return e.invoke(this.inlineInput,"getEditState")}isEditing(){const e=this.inlineInput.state;return e&&e.isEditing}handleToggleEditName(e){this.setState({isEditing:e}),e&&this.inlineInput&&(this.inlineInput.focus(),this.inlineInput.selectAll())}handleRenameSubmit(t){e.get(this.props,"text")!==t&&this.props.onRename(t)}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){this.setState({isHovered:!1})}onDropdownToggle(e){this.setState({isDropdownOpen:e},()=>{this.setState({isHovered:!1})})}handleDropdownSelect(e){this.setState({isDropdownOpen:!1}),this.props.onActionsDropdownSelect&&this.props.onActionsDropdownSelect(e)}handleLinkClick(e){"browser"===window.SDK_PLATFORM&&(e.ctrlKey||e.metaKey)||this.props.onClick&&this.props.onClick(e)}onClickActionContainer(e){e.stopPropagation()}render(){const t=e.get(this.props,"text","");return this.props.routeConfig?s.a.createElement("div",{className:this.getItemClasses(),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},s.a.createElement(h.default,{to:this.props.routeConfig,onClick:this.handleLinkClick,className:"sidebar-list-item__link",options:this.props.options||{}},s.a.createElement("div",{className:"sidebar-list-item__left-actions-container"},this.props.leftMetaComponent&&this.props.leftMetaComponent(this.state.isHovered,this.state.isDropdownOpen)),s.a.createElement("div",{className:r()({"sidebar-list-item__content-wrapper":!0,"edit-mode":this.state.isEditing})},this.props.icon?s.a.createElement("div",{className:"sidebar-list-item__icon-container"},"string"==typeof this.props.icon?s.a.createElement(d.Icon,{name:this.props.icon,color:"content-color-secondary"}):this.props.icon):null,s.a.createElement("div",{className:r()({"sidebar-list-item__name-wrapper":!0,"is-forked":this.props.isForked}),title:t},this.props.onRename?s.a.createElement(a.default,{className:"sidebar-list-item__name",ref:this.containerRef,value:t,onSubmit:this.handleRenameSubmit,onToggleEdit:this.handleToggleEditName}):t),s.a.createElement("div",{className:"sidebar-list-item__status-indicators"},this.props.statusIndicators?this.props.statusIndicators():null))),s.a.createElement("div",{className:"sidebar-list-item__actions-container",onClick:this.onClickActionContainer},this.props.rightMetaComponent&&this.props.rightMetaComponent(this.state.isHovered,this.state.isDropdownOpen),this.props.moreActions&&(this.state.isHovered||this.state.isDropdownOpen)?s.a.createElement(c.Dropdown,{ref:"menu",onSelect:this.handleDropdownSelect,className:"actions-dropdown",onToggle:this.onDropdownToggle},s.a.createElement(c.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},s.a.createElement(l.Button,{tooltip:"View more actions",className:"sidebar-action-btn"},s.a.createElement(d.Icon,{name:"icon-action-options-stroke",className:"pm-icon pm-icon-normal"}))),this.props.moreActions):null)):s.a.createElement("div",{className:this.getItemClasses(),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.props.onClick},s.a.createElement("div",{className:"sidebar-list-item__left-actions-container"},this.props.leftMetaComponent&&this.props.leftMetaComponent(this.state.isHovered,this.state.isDropdownOpen)),s.a.createElement("div",{className:r()({"sidebar-list-item__content-wrapper":!0,"edit-mode":this.state.isEditing})},this.props.icon?s.a.createElement("div",{className:"sidebar-list-item__icon-container"},"string"==typeof this.props.icon?s.a.createElement(d.Icon,{name:this.props.icon,color:"content-color-secondary"}):this.props.icon):null,s.a.createElement("div",{className:r()({"sidebar-list-item__name-wrapper":!0,"is-forked":this.props.isForked}),title:t},this.props.onRename?s.a.createElement(a.default,{className:"sidebar-list-item__name",ref:this.containerRef,value:t,onSubmit:this.handleRenameSubmit,onToggleEdit:this.handleToggleEditName}):t,this.props.statusIndicators?this.props.statusIndicators():null)),s.a.createElement("div",{className:"sidebar-list-item__actions-container",onClick:this.onClickActionContainer},this.props.rightMetaComponent&&this.props.rightMetaComponent(this.state.isHovered,this.state.isDropdownOpen),this.props.moreActions&&(this.state.isHovered||this.state.isDropdownOpen)?s.a.createElement(c.Dropdown,{ref:"menu",onSelect:this.handleDropdownSelect,className:"actions-dropdown",onToggle:this.onDropdownToggle},s.a.createElement(c.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},s.a.createElement(l.Button,{tooltip:"View more actions",className:"sidebar-action-btn"},s.a.createElement(d.Icon,{name:"icon-action-options-stroke",className:"pm-icon pm-icon-normal"}))),this.props.moreActions):null))}}}.call(this,i(1132))},7796:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return p}));var n,s=i(192),o=i.n(s),r=i(2427),a=i(1503),c=i(7797),l=i(2920),d=i(4178),h=i(3040);let p=Object(a.observer)(n=class extends s.Component{constructor(e){super(e),this.handleDropdownSelect=this.handleDropdownSelect.bind(this)}handleDropdownSelect(e){this.props.onActionsDropdownSelect&&this.props.onActionsDropdownSelect(e)}getCreateNewButton(e){if(!e)return null;const t=o.a.createElement(l.Button,{className:"create-new__btn",onClick:e.onCreate,tooltip:e.tooltip,disabled:e.disabled,type:"icon"},o.a.createElement(r.Icon,{name:"icon-action-add-stroke",size:"large",color:"content-color-secondary"}));return e.xPathIdentifier?o.a.createElement(h.default,{identifier:e.xPathIdentifier},t):t}render(){return o.a.createElement("div",{className:"requester-left-sidebar__actions-container"},this.getCreateNewButton(this.props.createNewConfig),o.a.createElement(c.default,{onSearch:this.props.onSearch,className:this.props.className,searchQuery:this.props.searchQuery}),this.props.rightMetaContainer||this.props.moreActions?o.a.createElement("div",{className:"secondary-actions-container"},this.props.rightMetaContainer,this.props.moreActions?o.a.createElement(d.Dropdown,{ref:"menu",onSelect:this.handleDropdownSelect,className:"actions-dropdown"},o.a.createElement(d.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},o.a.createElement(l.Button,{tooltip:"View more actions"},o.a.createElement(r.Icon,{name:"icon-action-options-stroke",className:"dropdown-action-button pm-icon pm-icon-normal"}))),this.props.moreActions):null):"")}})||n},7797:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"default",(function(){return l}));var n,s=i(192),o=i.n(s),r=(i(3285),i(1503)),a=i(3040),c=i(3797);let l=Object(r.observer)(n=class extends s.Component{constructor(e){super(e),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleSearchCancel=this.handleSearchCancel.bind(this),this.focusSearchBox=this.focusSearchBox.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("focusSearchBox",this.focusSearchBox)}componentWillUnmount(){pm.mediator.off("focusSearchBox",this.focusSearchBox)}focusSearchBox(){e.invoke(this,"refs.filter.focus")}handleSearchChange(e){this.props.onSearch&&this.props.onSearch(e)}handleSearchCancel(){this.props.onSearch&&this.props.onSearch("")}render(){return o.a.createElement(a.default,{identifier:"filter"},o.a.createElement(c.Input,{icon:"icon-action-filter-stroke",ref:"filter",inputStyle:"search",onChange:this.handleSearchChange,onCancel:this.handleSearchCancel,query:this.props.searchQuery,className:this.props.className}))}})||n}.call(this,i(1132))},7798:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return l}));var n=i(192),s=i.n(n),o=i(195),r=i.n(o),a=i(2427),c=i(2920);class l extends n.Component{constructor(e){super(e),this.handleAction=this.handleAction.bind(this)}handleAction(){this.props.action.handler&&this.props.action.handler()}render(){return s.a.createElement("div",{className:"sidebar-empty-state"},s.a.createElement("div",{className:"sidebar-empty-state__illustration"},this.props.illustration?this.props.illustration:null),s.a.createElement("div",{className:"sidebar-empty-state__head-and-body"},s.a.createElement("div",{className:"sidebar-empty-state__title"},s.a.createElement(a.Heading,{type:"h4",color:"content-color-secondary",text:this.props.title})),s.a.createElement("div",{className:"sidebar-empty-state__description"},s.a.createElement(a.Text,{type:"body-medium",color:"content-color-secondary"},this.props.message))),this.props.action&&s.a.createElement("div",{className:"sidebar-empty-state__cta"},s.a.createElement(c.Button,{type:"text",onClick:this.handleAction,disabled:!this.props.hasPermissions,tooltip:this.props.action.tooltip},this.props.action.label)))}}l.defaultProps={action:null,hasPermissions:!0},l.propTypes={illustration:r.a.node,title:r.a.string.isRequired,message:r.a.string.isRequired,action:r.a.shape({label:r.a.oneOfType([r.a.object,r.a.string]).isRequired,handler:r.a.func.isRequired,tooltip:r.a.string}),hasPermissions:r.a.bool}},8466:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"default",(function(){return m}));var n,s=i(192),o=i.n(s),r=i(195),a=i.n(r),c=i(1503),l=i(3285),d=i(8467),h=i(4593),p=i(8472);let m=Object(c.observer)(n=class extends s.Component{render(){const{controller:t}=this.props,{isConsistentlyOffline:i}=Object(l.getStore)("SyncStatusStore");return!pm.isScratchpad&&i&&e.get(t,"model.isLoading")?o.a.createElement(h.SidebarOfflineState,null):o.a.createElement(d.default,{model:t.model})}})||n;m.propTypes={controller:a.a.shape({model:a.a.instanceOf(p.default)}).isRequired}}.call(this,i(1132))},8467:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return m}));var n,s=i(192),o=i.n(s),r=i(195),a=i.n(r),c=i(1503),l=i(3040),d=i(8468),h=i(8469),p=i(8472);let m=Object(c.observer)(n=class extends s.Component{render(){return o.a.createElement("div",{className:"env-sidebar-container"},o.a.createElement(d.default,{model:this.props.model}),o.a.createElement(l.default,{identifier:"environment"},o.a.createElement(h.default,{model:this.props.model})))}})||n;m.propTypes={model:a.a.instanceOf(p.default).isRequired}},8468:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return h}));var n,s=i(192),o=i.n(s),r=i(1503),a=i(3285),c=i(7796),l=i(4858),d=i(4603);let h=Object(r.observer)(n=class extends s.Component{constructor(e){super(e),this.state={isEnvCreateEnabled:!0},this.handleCreate=this.handleCreate.bind(this),this.handleSearchChange=this.handleSearchChange.bind(this)}handleCreate(){this.setState({isEnvCreateEnabled:!1}),this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.setState({isEnvCreateEnabled:!0})},1e3),Object(l.createEnvironment)({openInTab:!0})}handleSearchChange(e){this.props.model&&this.props.model.setSearchQuery(e)}render(){const{userCanSave:e}=Object(a.getStore)("OnlineStatusStore"),t=Object(a.getStore)("PermissionStore").can("addEnvironment","workspace",Object(a.getStore)("ActiveWorkspaceStore").id),i=e&&t&&this.state.isEnvCreateEnabled;return o.a.createElement(c.default,{createNewConfig:{tooltip:e?t?"Create new Environment":d.DISABLED_TOOLTIP_NO_PERMISSION:d.DISABLED_TOOLTIP_IS_OFFLINE,disabled:!i,onCreate:this.handleCreate,xPathIdentifier:"addEnvironment"},onSearch:this.handleSearchChange,searchQuery:this.props.model.searchQuery})}})||n},8469:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"default",(function(){return _}));var n,s=i(192),o=i.n(s),r=i(195),a=i.n(r),c=i(1505),l=i(1503),d=i(753),h=i.n(d),p=i(1849),m=i(1850),u=i(2427),b=i(2989),E=i(3285),v=i(3040),f=i(8470),S=i(8471),g=i(8472),O=i(4858),y=i(3811),I=i(4859),C=i(3815),A=i(7798),w=i(7057),T=i(6679);let _=h()(n=Object(l.observer)(n=class extends s.Component{constructor(e){super(e),this.editCache=null,this.listItemRefs={},this.getItemSize=this.getItemSize.bind(this),this.scrollToItem=this.scrollToItem.bind(this),this.setEditCache=this.setEditCache.bind(this),this.saveCachedValue=this.saveCachedValue.bind(this),this.handleClickOutside=this.handleClickOutside.bind(this),this.focusNext=this.focusNext.bind(this),this.focusPrev=this.focusPrev.bind(this),this.deleteItem=this.deleteItem.bind(this),this.renameItem=this.renameItem.bind(this),this.duplicateItem=this.duplicateItem.bind(this)}componentDidMount(){this.scrollToViewReactionDisposer=Object(c.reaction)(()=>e.get(this.props,"model.activeItemIndex"),e=>this.scrollToItem(e)),this.resetHeightReactionDisposer=Object(c.reaction)(()=>e.get(this.props,"model.items"),()=>{this.listRef&&this.listRef.resetAfterIndex(0)})}componentWillUnmount(){this.scrollToViewReactionDisposer&&this.scrollToViewReactionDisposer(),this.resetHeightReactionDisposer&&this.resetHeightReactionDisposer(),clearTimeout(this.clearCollectionLoadingTimer)}getSidebarEmptyState(){const e=Object(E.getStore)("PermissionStore").can("addEnvironment","workspace",Object(E.getStore)("ActiveWorkspaceStore").id);return o.a.createElement(A.default,{illustration:o.a.createElement(u.IllustrationNoEnvironment,null),title:"You donâ€™t have any environments.",message:"An environment is a set of variables that allows you to switch the context of your requests.",action:e&&{label:"Create Environment",handler:O.createEnvironment}})}getGlobalsListItem(){return o.a.createElement(v.default,{identifier:"globals"},o.a.createElement(S.default,{model:this.props.model.globals}))}getItemSize(){return 28}getListItem({style:t,index:i}){const{model:n}=this.props,s=e.get(n,["items",i]);if(!s)return null;const{id:r}=s;return o.a.createElement(v.default,{identifier:r},o.a.createElement("div",{style:t},o.a.createElement(f.default,{ref:e=>{this.listItemRefs[r]=e},key:r,index:i,item:s,model:n,setEditCache:this.setEditCache,editCache:e.get(this.editCache,"index")===i?this.editCache:null})))}getKeyMapHandlers(){return{quit:pm.shortcuts.handle("quit",this.setEditCache.bind(this,null)),select:pm.shortcuts.handle("select",this.saveCachedValue),nextItem:pm.shortcuts.handle("nextItem",this.focusNext),prevItem:pm.shortcuts.handle("prevItem",this.focusPrev),delete:pm.shortcuts.handle("delete",this.deleteItem),rename:pm.shortcuts.handle("rename",this.renameItem),duplicate:pm.shortcuts.handle("duplicate",this.duplicateItem)}}setEditCache(e){this.editCache=e}saveCachedValue(){if(!this.editCache)return;const{index:t,inlineInput:i}=this.editCache,n=e.get(this.props.model,["items",t]),s=(o=i,e.get(o,"inlineInput.value"));var o;n&&!e.isNil(s)&&this.props.model.handleAction(n.id,I.ACTION_TYPE_RENAME,{name:s})}focusNext(e){e&&e.preventDefault(),this.props.model.focusNext()}focusPrev(e){e&&e.preventDefault(),this.props.model.focusPrev()}deleteItem(){this.props.model.handleAction(e.get(this.props.model,"activeItem"),I.ACTION_TYPE_DELETE)}renameItem(){if(!Object(E.getStore)("OnlineStatusStore").userCanSave)return Object(y.showOfflineActionDisabledToast)();e.invoke(this.listItemRefs,[e.get(this.props.model,"activeItem"),"handleEditName"])}duplicateItem(){this.props.model.handleAction(e.get(this.props.model,"activeItem"),I.ACTION_TYPE_DUPLICATE)}handleClickOutside(e){const t="input input-box inline-input"===(e&&e.target&&e.target.className);this.editCache&&!t&&this.saveCachedValue()}scrollToItem(t){!e.isEmpty(this.listRef)&&!e.isNil(t)&&this.listRef.scrollToItem(t)}render(){const{model:t}=this.props,i=e.size(t.items);if(t.isLoading)return o.a.createElement("div",{className:"env-sidebar-list-container"},this.getGlobalsListItem(),o.a.createElement(T.default,null));if(e.isEmpty(t.items)){if(e.isEmpty(t.searchQuery))return o.a.createElement("div",{className:"env-sidebar-list-container"},this.getGlobalsListItem(),this.getSidebarEmptyState());if(!C.GLOBALS.includes(t.searchQuery))return o.a.createElement(w.default,{searchQuery:t.searchQuery,illustration:o.a.createElement(u.IllustrationNoEnvironment,null)})}const n=e=>o.a.createElement(l.Observer,null,this.getListItem.bind(this,e));return o.a.createElement(b.default,{keyMap:pm.shortcuts.getShortcuts(),handlers:this.getKeyMapHandlers()},o.a.createElement("div",{className:"env-sidebar-list-container",onClick:this.handleClickOutside},this.getGlobalsListItem(),o.a.createElement("div",{className:"env-sidebar-list"},o.a.createElement(p.default,null,({height:e,width:t})=>o.a.createElement(m.VariableSizeList,{height:e,width:t,itemCount:i,itemSize:this.getItemSize,overscanCount:10,ref:e=>{this.listRef=e}},n)))))}})||n)||n;_.propTypes={model:a.a.instanceOf(g.default).isRequired}}.call(this,i(1132))},8470:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"default",(function(){return I}));var n,s=i(192),o=i.n(s),r=i(1503),a=i(1344),c=i.n(a),l=i(195),d=i.n(l),h=i(2427),p=i(7794),m=i(3285),u=i(4626),b=i(2920),E=i(3040),v=i(5008),f=i(4859),S=i(4593),g=i(4671),O=i(3811),y=i(4603);let I=Object(r.observer)(n=class extends s.Component{constructor(e){super(e),this.handleEditName=this.handleEditName.bind(this),this.handleItemSelect=this.handleItemSelect.bind(this),this.handleRenameSubmit=this.handleRenameSubmit.bind(this),this.handleSetActiveEnvironment=this.handleSetActiveEnvironment.bind(this),this.handleRemoveActiveEnvironment=this.handleRemoveActiveEnvironment.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.containerRef=this.containerRef.bind(this),this.getStatusIndicators=this.getStatusIndicators.bind(this),this.getDisabledText=this.getDisabledText.bind(this)}componentDidMount(){this.props.editCache&&this.listItemRef&&(this.handleEditName(),this.listItemRef.setEditState(this.props.editCache.inlineInput))}componentWillUnmount(){const{listItemRef:e}=this;e&&e.isEditing()&&this.props.setEditCache({index:this.props.index,inlineInput:e.getEditState()})}getStatusIndicators(){return o.a.createElement(v.default,{environment:this.props.item,showForkLabel:!0})}getRightAlignedContainer(e,t){const i=c()({"env-actions-icon-container":!0,isHovered:e||t,isActive:this.props.item.isActive});return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:i},o.a.createElement(b.Button,{type:"icon",tooltip:"Set inactive",onClick:this.handleRemoveActiveEnvironment,className:"sidebar-action-btn active-env-icon"},o.a.createElement(h.Icon,{name:"icon-state-success-fill-small",size:"large",color:"content-color-primary"})),o.a.createElement(b.Button,{type:"icon",tooltip:"Set active",onClick:this.handleSetActiveEnvironment,className:"sidebar-action-btn inactive-env-icon"},o.a.createElement(h.Icon,{name:"icon-state-success-stroke",size:"large",color:"content-color-primary"}))),!e&&!t&&this.props.item.isActive&&o.a.createElement("div",{className:"env-actions__more-actions-placeholder"}))}getDisabledText(e,t){if(!e)return;if(pm.isScratchpad)return g.DISABLED_IN_SCRATCHPAD_TOOLTIP;if(!Object(m.getStore)("OnlineStatusStore").userCanSave)return y.DISABLED_TOOLTIP_IS_OFFLINE;const i=y.DISABLED_TOOLTIP_NO_PERMISSION,n=Object(m.getStore)("ActiveWorkspaceStore").id;switch(t){case f.ACTION_MANAGE_ROLES:return"You need to be signed-in to a team to perform this action";case f.ACTION_REMOVE_FROM_WORKSPACE:return Object(m.getStore)("PermissionStore").can("removeEnvironment","workspace",n)?"Get online to perform this action":i;case f.ACTION_TYPE_PULL_REQUEST:case f.ACTION_TYPE_MERGE:return"Coming soon in a future release!";default:return i}}getMenuItemIconClasses(e){return c()({"dropdown-menu-item-icon":!0},{"pm-icon":!0},{"pm-icon-normal":!0},"menu-icon--"+e)}getMenuItems(){const{model:t,item:i}=this.props;return e.map(t.getActions(i.id),e=>{const t=o.a.createElement("span",{className:"env-action-item"},o.a.createElement("div",{className:"dropdown-menu-item-label"},e.label),e.shortcut&&o.a.createElement("div",{className:"dropdown-menu-item-shortcut"},Object(u.getShortcutByName)(e.shortcut)));return!e.hide&&o.a.createElement(S.MenuItem,{key:e.type,refKey:e.type,disabled:!e.isEnabled,disabledText:this.getDisabledText(!e.isEnabled,e.type)},e.xpathLabel?o.a.createElement(E.default,{identifier:e.xpathLabel},t):t)})}getActionsMenuItems(){return o.a.createElement(S.DropdownMenu,{className:"env-dropdown-menu","align-right":!0},this.getMenuItems())}containerRef(e){this.listItemRef=e}handleSetActiveEnvironment(){this.props.model.handleAction(this.props.item.id,f.ACTION_TYPE_SET_ACTIVE)}handleRemoveActiveEnvironment(){this.props.model.handleAction(this.props.item.id,f.ACTION_TYPE_SET_ACTIVE,{noEnvironment:!0})}handleEditName(){e.invoke(this.listItemRef,"editText")}async handleRenameSubmit(e){await this.props.model.handleAction(this.props.item.id,f.ACTION_TYPE_RENAME,{name:e}),this.props.setEditCache(null)}async handleDropdownActionSelect(e){if(e===f.ACTION_TYPE_RENAME_TOGGLE)return Object(m.getStore)("OnlineStatusStore").userCanSave?this.handleEditName():Object(O.showOfflineActionDisabledToast)();await this.props.model.handleAction(this.props.item.id,e)}handleItemSelect(){this.props.model.openInTab(this.props.item.id)}render(){const{item:t,model:i}=this.props;return o.a.createElement(p.default,{ref:this.containerRef,text:t.name,isForked:!(!e.get(t,"attributes.fork.forkId")&&!e.get(t,"attributes.fork.id")),isSelected:i.activeItem===t.id,onClick:this.handleItemSelect,onRename:this.handleRenameSubmit,statusIndicators:this.getStatusIndicators,rightMetaComponent:(...e)=>o.a.createElement(r.Observer,null,this.getRightAlignedContainer.bind(this,...e)),moreActions:this.getActionsMenuItems(),onActionsDropdownSelect:this.handleDropdownActionSelect})}})||n;I.propTypes={index:d.a.number.isRequired,item:d.a.object.isRequired,model:d.a.object.isRequired,editCache:d.a.object.isRequired,setEditCache:d.a.func.isRequired}}.call(this,i(1132))},8471:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return m}));var n,s=i(192),o=i.n(s),r=i(1503),a=i(1344),c=i.n(a),l=i(195),d=i.n(l),h=i(7794),p=i(8472);let m=Object(r.observer)(n=class extends s.Component{constructor(e){super(e),this.handleSelect=this.handleSelect.bind(this)}getItemClasses(){return c()({"globals-sidebar-list-item":!0,selected:this.props.model.isActive})}handleSelect(){this.props.model.openInTab()}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.default,{text:"Globals",isSelected:this.props.model.isActive,onClick:this.handleSelect}),o.a.createElement("div",{className:"globals-separator"}))}})||n;m.propTypes={model:d.a.instanceOf(p.GlobalsModel).isRequired}},8472:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"GlobalsModel",(function(){return T})),i.d(t,"EnvironmentModel",(function(){return _})),i.d(t,"default",(function(){return N}));var n,s,o,r,a,c,l,d,h,p,m=i(1505),u=i(3285),b=i(2941),E=i(3831),v=i(3832),f=i(3300),S=i(3815),g=i(4858),O=i(7438),y=i(3811),I=i(4859);function C(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function A(e,t,i,n,s){var o={};return Object.keys(n).forEach((function(e){o[e]=n[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),o),s&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(s):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}const w=["name","createdAt"];let T=(s=A((n=class{constructor(){C(this,"isActive",s,this),this._disposer=Object(m.autorun)(()=>{const e=Object(u.getStore)("EditorStore").find(Object(u.getStore)("ActiveWorkspaceSessionStore").activeEditor);e&&e.resource&&e.resource.includes(S.GLOBALS)?this.setFocus(!0):this.setFocus(!1)})}dispose(){this._disposer()}setFocus(e){this.isActive=e}openInTab(){Object(g.openGlobalsInTab)()}}).prototype,"isActive",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A(n.prototype,"setFocus",[m.action],Object.getOwnPropertyDescriptor(n.prototype,"setFocus"),n.prototype),n),_=(A((o=class extends O.default{updateName(e){this.update({name:e})}get isActive(){return Object(u.getStore)("ActiveEnvironmentStore").id===Object(f.decomposeUID)(this.id).modelId}}).prototype,"updateName",[m.action],Object.getOwnPropertyDescriptor(o.prototype,"updateName"),o.prototype),A(o.prototype,"isActive",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"isActive"),o.prototype),o),N=(a=A((r=class{constructor(){C(this,"activeItem",a,this),C(this,"sortBy",c,this),C(this,"searchQuery",l,this),C(this,"$items",d,this),C(this,"isLoading",h,this),C(this,"sharedEnvironments",p,this),this.globals=new T,this._dispose=Object(m.autorun)(()=>{const e=Object(u.getStore)("EditorStore").find(Object(u.getStore)("ActiveWorkspaceSessionStore").activeEditor);if(e)if(e.resource.includes(S.ENVIRONMENT)){const t=e.resource.split("/").pop();this.focusItem(t)}else this.resetFocus();else this.resetFocus()}),this.openEntityInTabDebounced=e.debounce(e=>{b.default.transitionTo("build.environment",{eid:e})},300)}dispose(){this.globals.dispose(),this._dispose()}get filtered(){if(!this.searchQuery.trim())return[...this.$items.values()];const t=e.toLower(this.searchQuery);return e.filter([...this.$items.values()],i=>e.includes(e.toLower(i.name),t))}isInActiveWorkspace(t){return e.get(Object(u.getStore)("ActiveWorkspaceStore"),"dependencies.environments",[]).includes(t)}get items(){const t=e.filter(this.filtered,e=>this.isInActiveWorkspace(e.id));return e.sortBy(t,t=>t&&[e.toLower(t[this.sortBy]),e.toLower(t.name)])}get activeItemIndex(){return e.findIndex(this.items,e=>e.id===this.activeItem)}setSearchQuery(e){this.searchQuery=e}setSortingKey(t){e.includes(w,t)&&(this.sortBy=t)}focusItem(e){e&&(this.activeItem=e)}resetFocus(){this.activeItem=null}setLoading(e){this.isLoading=e}setSharedEnvironments(e){this.sharedEnvironments=new Set(e)}focusNext(){if(!this.activeItem)return;if(e.isEmpty(this.items))return void this.resetFocus();const t=this.items[(this.activeItemIndex+1)%this.items.length].id;this.focusItem(t),this.openEntityInTabDebounced(t)}focusPrev(){if(!this.activeItem||1===e.size(this.items))return;if(e.isEmpty(this.items))return void this.resetFocus();const t=this.activeItemIndex<=0?e.last(this.items).id:this.items[this.activeItemIndex-1].id;this.focusItem(t),this.openEntityInTabDebounced(t)}openInTab(e){this.openEntityInTabDebounced(e)}getActions(e){const t=this.$items.get(e),i=Object(u.getStore)("ActiveWorkspaceStore").id,n=Object(u.getStore)("PermissionStore"),s=Object(u.getStore)("CurrentUserStore"),{userCanSave:o,userCanSaveAndSync:r}=Object(u.getStore)("OnlineStatusStore");return[{type:I.ACTION_TYPE_SHARE,label:"Share environment",isEnabled:r&&t.userCanShare},{type:I.ACTION_TYPE_RENAME_TOGGLE,label:"Rename",shortcut:"rename",isEnabled:o&&t.userCanUpdate},{type:I.ACTION_TYPE_DUPLICATE,label:"Duplicate",shortcut:"duplicate",isEnabled:o&&n.can("addEnvironment","workspace",i)},{type:I.ACTION_TYPE_FORK,label:"Create a Fork",shortcut:"fork",isEnabled:r},{type:I.ACTION_TYPE_PULL_REQUEST,label:"Create Pull Request",isEnabled:!1},{type:I.ACTION_TYPE_MERGE,label:"Merge changes",isEnabled:!1},{type:I.ACTION_MANAGE_ROLES,label:"Manage Roles",isEnabled:r&&!!s.team},{type:I.ACTION_REMOVE_FROM_WORKSPACE,label:"Remove from workspace",isEnabled:r&&n.can("removeEnvironment","workspace",i)},{type:I.ACTION_TYPE_DELETE,label:"Delete",shortcut:"delete",isEnabled:o&&t.userCanDelete}]}async handleAction(e,t,i={}){const n=this.$items.get(e),s=Object(u.getStore)("PermissionStore"),o=Object(u.getStore)("ActiveWorkspaceStore").id,r=Object(u.getStore)("CurrentUserStore");if(t!==I.ACTION_TYPE_SET_ACTIVE){if(t===I.ACTION_TYPE_SHARE)return Object(u.getStore)("OnlineStatusStore").userCanSaveAndSync?n.userCanShare?void Object(E.shareEnvironment)(e,{origin:"sidebar"}):void pm.toasts.error("You do not have permissions to perform this action"):Object(y.showOfflineActionDisabledToast)();if(t===I.ACTION_TYPE_FORK)return Object(u.getStore)("OnlineStatusStore").userCanSaveAndSync?void Object(g.forkEnvironment)(e,{origin:"sidebar"}):Object(y.showOfflineActionDisabledToast)();if(t!==I.ACTION_TYPE_DUPLICATE){if(t===I.ACTION_TYPE_RENAME)return Object(u.getStore)("OnlineStatusStore").userCanSave?(await Object(g.renameEnvironment)(e,i.name),n.updateName(i.name),pm.mediator.trigger("focusSidebar"),void await Object(g.__forceUpdateNameOnDb)(e,i.name)):Object(y.showOfflineActionDisabledToast)();if(t!==I.ACTION_MANAGE_ROLES){if(t===I.ACTION_REMOVE_FROM_WORKSPACE)return Object(u.getStore)("OnlineStatusStore").userCanSaveAndSync?s.can("removeEnvironment","workspace",o)?void pm.mediator.trigger("showRemoveFromWorkspaceModal",e,{type:"environment",origin:"sidebar",disableDelete:!n.userCanDelete,disableShare:!n.userCanShare},()=>{e===this.activeItem&&this.focusPrev({openEditor:!1}),this.remove(e),Object(g.closeAllEnvironmentTabs)(e)}):void pm.toasts.error("You do not have permissions to perform this action"):Object(y.showOfflineActionDisabledToast)();if(t!==I.ACTION_TYPE_DELETE)pm.logger.warn("EnvironmentSidebarModel~handleAction",`Unhandled action ${t} triggered`);else{if(!Object(u.getStore)("OnlineStatusStore").userCanSave)return Object(y.showOfflineActionDisabledToast)();if(!n.userCanDelete)return void pm.toasts.error("You do not have permissions to perform this action");await Object(g.deleteEnvironment)(e,{name:this.$items.get(e).name})&&(e===this.activeItem&&this.focusPrev({openEditor:!1}),this.remove(e))}}else{if(!Object(u.getStore)("OnlineStatusStore").userCanSaveAndSync)return Object(y.showOfflineActionDisabledToast)();if(!r.team)return;Object(v.manageRolesOnEnvironment)(e,{origin:"sidebar"})}}else{if(!Object(u.getStore)("OnlineStatusStore").userCanSave)return Object(y.showOfflineActionDisabledToast)();const{id:t,name:i}=await Object(g.duplicateEnvironment)(e);this.add({id:t,name:i,attributes:n.attributes})}}else try{n.isActive?await Object(g.setNoActiveEnvironment)():await Object(g.setActiveEnvironment)(e)}catch(e){pm.logger.error("EnvironmentSidebarModel~handleAction",e),pm.toasts.error("There was a error while setting the active environment")}}hydrate(e){e&&e.forEach(e=>{this.$items.set(e.id,new _(e))})}add(e){Array.isArray(e)||(e=[e]),e.forEach(e=>{e&&e.id&&this.$items.set(e.id,new _(e))})}update(e){if(!e||!e.id)return;const t=this.$items.get(e.id);t&&t.update(e)}remove(e){Array.isArray(e)||(e=[e]),e.forEach(e=>this.$items.delete(e))}clear(){this.$items.clear()}}).prototype,"activeItem",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=A(r.prototype,"sortBy",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"name"}}),l=A(r.prototype,"searchQuery",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),d=A(r.prototype,"$items",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),h=A(r.prototype,"isLoading",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),p=A(r.prototype,"sharedEnvironments",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),A(r.prototype,"filtered",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"filtered"),r.prototype),A(r.prototype,"items",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"items"),r.prototype),A(r.prototype,"activeItemIndex",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"activeItemIndex"),r.prototype),A(r.prototype,"setSearchQuery",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"setSearchQuery"),r.prototype),A(r.prototype,"setSortingKey",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"setSortingKey"),r.prototype),A(r.prototype,"focusItem",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"focusItem"),r.prototype),A(r.prototype,"resetFocus",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"resetFocus"),r.prototype),A(r.prototype,"setLoading",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"setLoading"),r.prototype),A(r.prototype,"setSharedEnvironments",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"setSharedEnvironments"),r.prototype),A(r.prototype,"handleAction",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"handleAction"),r.prototype),A(r.prototype,"hydrate",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"hydrate"),r.prototype),A(r.prototype,"add",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"add"),r.prototype),A(r.prototype,"update",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"update"),r.prototype),A(r.prototype,"remove",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"remove"),r.prototype),A(r.prototype,"clear",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"clear"),r.prototype),r)}.call(this,i(1132))}}]);
//# sourceMappingURL=EnvironmentSidebarView-ef4562957c2c65009c3f.min.js.map